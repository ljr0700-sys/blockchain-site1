<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>부동산 자산 디지털화 플랫폼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #050816;
      color: #f5f5f5;
      line-height: 1.6;
    }
    a { color: #ffd36b; text-decoration: none; }
    header {
      padding: 18px 20px 14px;
      background: linear-gradient(135deg, #1555ff, #26a5ff);
      color: #fff;
    }
    header h1 {
      margin: 0;
      font-size: 24px;
    }
    header p {
      margin: 4px 0 0;
      font-size: 13px;
      opacity: 0.9;
    }

    .wrap {
      max-width: 1080px;
      margin: 0 auto;
      display: flex;
      min-height: calc(100vh - 80px);
    }

    nav.sidebar {
      width: 230px;
      padding: 16px 12px 40px;
      background: #050816;
      border-right: 1px solid rgba(255, 255, 255, 0.08);
    }

    .menu-title {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 10px;
      color: #ffe78a;
    }

    .menu-list {
      list-style: none;
      padding: 0;
      margin: 0 0 16px;
    }

    .menu-list li {
      margin-bottom: 6px;
    }

    .menu-btn {
      width: 100%;
      text-align: left;
      border: none;
      outline: none;
      cursor: pointer;
      padding: 7px 10px;
      border-radius: 6px;
      font-size: 14px;
      background: transparent;
      color: #e5e5e5;
      transition: background 0.15s, color 0.15s;
    }

    .menu-btn:hover {
      background: rgba(255, 255, 255, 0.04);
    }

    .menu-btn.active {
      background: #1a4dff;
      color: #fff;
      font-weight: 600;
    }

    .login-small {
      margin-top: 12px;
      padding: 10px 10px 8px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px;
      font-size: 12px;
      color: #cfcfcf;
    }

    .login-small span {
      display: block;
    }

    .login-small button {
      margin-top: 6px;
      padding: 5px 8px;
      font-size: 12px;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: transparent;
      color: #f5f5f5;
      cursor: pointer;
    }

    main.content {
      flex: 1;
      padding: 20px 20px 40px;
    }

    .panel {
      background: radial-gradient(circle at top left, rgba(255,255,255,0.06), transparent 55%);
      border-radius: 12px;
      padding: 18px 18px 20px;
      margin-bottom: 16px;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .panel h2 {
      margin: 0 0 8px;
      font-size: 18px;
    }

    .panel h3 {
      margin: 16px 0 6px;
      font-size: 15px;
    }

    .panel p {
      margin: 3px 0;
      font-size: 13px;
    }

    .tag {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.4);
      font-size: 11px;
      margin-left: 6px;
      vertical-align: middle;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 14px;
    }

    .field-row {
      margin-bottom: 8px;
      font-size: 13px;
    }

    .field-row label {
      display: block;
      margin-bottom: 3px;
    }

    input[type="text"],
    input[type="password"],
    input[type="number"],
    textarea,
    select {
      width: 100%;
      padding: 7px 8px;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      background: rgba(7, 10, 30, 0.95);
      color: #f5f5f5;
      font-size: 13px;
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    .btn {
      padding: 7px 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
    }

    .btn-primary {
      background: linear-gradient(135deg, #246bff, #26d0ff);
      color: #fff;
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.25);
      color: #f5f5f5;
    }

    .btn-row {
      margin-top: 10px;
      display: flex;
      gap: 8px;
    }

    .note {
      font-size: 12px;
      color: #c9c9c9;
      margin-top: 6px;
    }

    .highlight-box {
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.45);
      font-size: 12px;
    }

    .token-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 12px;
    }

    .token-table th,
    .token-table td {
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 5px 6px;
      text-align: center;
    }

    .token-table th {
      background: rgba(255, 255, 255, 0.06);
    }

    .hidden {
      display: none !important;
    }

    .badge-role {
      display: inline-block;
      padding: 2px 6px;
      font-size: 11px;
      border-radius: 999px;
      margin-left: 4px;
      background: rgba(255, 211, 107, 0.12);
      border: 1px solid rgba(255, 211, 107, 0.5);
    }

    @media (max-width: 900px) {
      .wrap { flex-direction: column; }
      nav.sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid rgba(255, 255, 255, 0.12);
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .menu-title {
        width: 100%;
        margin-bottom: 4px;
      }
      .menu-list {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .menu-list li {
        margin-bottom: 0;
      }
      .menu-btn {
        font-size: 12px;
        padding: 6px 8px;
      }
      .login-small {
        width: 100%;
      }
      main.content {
        padding: 14px 12px 30px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>부동산 자산 디지털화 플랫폼</h1>
    <p>부동산 정보 입력 · 토큰/코인 구조 설계 · 블록체인 기록까지 한 번에 체험해 보는 연습용 사이트입니다. (실제 투자 서비스 아님)</p>
  </header>

  <div class="wrap">
    <!-- 좌측 메뉴 -->
    <nav class="sidebar">
      <div class="menu-title">사이트 메뉴</div>
      <ul class="menu-list">
        <li><button class="menu-btn active" data-page="home">홈(개요)</button></li>
        <li><button class="menu-btn" data-page="signup">회원가입</button></li>
        <li><button class="menu-btn" data-page="profile">거주 정보</button></li>
        <li><button class="menu-btn" data-page="trade">매매·임대</button></li>
        <li><button class="menu-btn" data-page="concept">블록체인 개념</button></li>
        <li><button class="menu-btn" data-page="demo">부동산 자산 디지털화 체험(3단계)</button></li>
        <li><button class="menu-btn" data-page="virtual">가상 건축 프로젝트</button></li>
        <li><button class="menu-btn" data-page="mypage">마이페이지</button></li>
        <li><button class="menu-btn" data-page="admin">관리자(설계)</button></li>
      </ul>

      <div class="login-small" id="sidebar-login-info">
        <!-- JS에서 채워 넣음 -->
      </div>
    </nav>

    <!-- 메인 영역 -->
    <main class="content">

      <!-- 공통 로그인 패널 -->
      <section class="panel" id="login-panel">
        <h2>로그인 <span class="tag">공통</span></h2>
        <p style="font-size:13px; margin-top:4px;">
          예시 계정 : <strong>jung / sam377</strong> (아이디 / 비밀번호)<br/>
          실제 서비스가 아니라 이 브라우저 안에서만 저장되는 연습용 계정입니다.
        </p>
        <div class="grid-2" style="margin-top:8px;">
          <div>
            <div class="field-row">
              <label for="login-id">아이디</label>
              <input type="text" id="login-id" autocomplete="username" />
            </div>
            <div class="field-row">
              <label for="login-pw">비밀번호</label>
              <input type="password" id="login-pw" autocomplete="current-password" />
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="btn-login">로그인</button>
              <button class="btn btn-ghost" id="btn-logout">로그아웃</button>
            </div>
            <div class="note">
              처음 사용하시면 아래 <strong>회원가입</strong> 메뉴에서 계정을 만든 뒤 로그인해 보세요.
            </div>
          </div>
          <div>
            <h3>현재 로그인 상태</h3>
            <div id="login-status-box" class="highlight-box">
              아직 로그인하지 않았습니다.
            </div>
          </div>
        </div>
      </section>

      <!-- 1. 홈(개요) -->
      <section class="panel" id="page-home">
        <h2>1. 플랫폼 개요</h2>
        <p>
          이 사이트는 부동산을 <strong>디지털 자산(토큰)</strong>으로 표현했을 때의 흐름을 연습해 보는 데모입니다.
          전체 구조는 <strong>회원 → 부동산 정보 → 거래/임대 → 블록체인 기록</strong> 순서로 진행됩니다.
        </p>
        <p>
          실제 투자·투기 서비스가 아니라, 나중에 실제 서비스를 구현할 때 사용할
          <strong>아이디어와 설계·데이터 구조를 미리 실험</strong>해 보는 용도입니다.
        </p>

        <h3>이 사이트에서 해보는 것</h3>
        <ul style="font-size:13px; padding-left:18px; margin-top:4px;">
          <li>회원가입 메뉴에서 연습용 계정을 만듭니다.</li>
          <li>거주 정보·매매/임대 페이지에서 부동산 정보를 입력해 봅니다.</li>
          <li>블록체인 체험(3단계)에서 입력한 정보를 바탕으로 토큰/해시 값을 만들어 봅니다.</li>
        </ul>

        <!-- 관리자 코인/토큰 구조 상자 -->
        <h3 style="margin-top:16px;">가상 토큰/코인 구조 (연습 설계)</h3>
        <p style="font-size:13px;">
          아래 표는 <strong>예시 설계</strong>입니다. 실제 서비스에서 수치는 변경될 수 있고,
          관리자 페이지에서 조정하도록 설계할 예정입니다.
        </p>
        <table class="token-table">
          <thead>
            <tr>
              <th>구분</th>
              <th>발행 기준</th>
              <th>발행량 예시</th>
              <th>설명</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>기본 토큰</td>
              <td>부동산 1호 등록</td>
              <td>10,000개</td>
              <td>해당 부동산을 대표하는 디지털 지분</td>
            </tr>
            <tr>
              <td>거래 보너스</td>
              <td>거래 1건 기록</td>
              <td>100개</td>
              <td>거래 참여자에게 분배되는 리워드</td>
            </tr>
            <tr>
              <td>광고 보상</td>
              <td>광고 1회 노출 × N</td>
              <td>노출 수 × 1개</td>
              <td>광고주·플랫폼 사이 수익 분배 설계에 사용</td>
            </tr>
          </tbody>
        </table>
        <div class="note">
          이 표는 <strong>관리자 페이지</strong>에서 조정 가능한 값으로 구현할 예정입니다.  
          (오늘은 화면 구조만 만들고, 2단계에서 실제 계산 로직을 연결합니다.)
        </div>
      </section>

      <!-- 2. 회원가입 -->
      <section class="panel hidden" id="page-signup">
        <h2>2. 회원가입</h2>
        <p style="font-size:13px;">
          이곳은 연습용 회원가입입니다. 입력한 정보는 이 브라우저의 <strong>LocalStorage</strong>에만 저장되고,
          인터넷 서버에는 전송되지 않습니다.
        </p>

        <div class="grid-2" style="margin-top:8px;">
          <div>
            <div class="field-row">
              <label for="su-id">아이디</label>
              <input type="text" id="su-id" />
            </div>
            <div class="field-row">
              <label for="su-pw">비밀번호</label>
              <input type="password" id="su-pw" />
            </div>
            <div class="field-row">
              <label for="su-name">이름/별명</label>
              <input type="text" id="su-name" />
            </div>
            <div class="field-row">
              <label for="su-role">역할</label>
              <select id="su-role">
                <option value="resident">거주자</option>
                <option value="owner">매매/임대 운영자</option>
                <option value="advertiser">광고주</option>
                <option value="architect">가상 건축 설계자</option>
                <option value="admin">관리자</option>
              </select>
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="btn-signup">회원가입</button>
            </div>
          </div>
          <div>
            <h3>안내</h3>
            <p class="note">
              · 동일 아이디는 한 번만 등록됩니다.<br/>
              · 관리자 예시 계정은 <strong>jung / sam377</strong> 으로 기본 제공됩니다.<br/>
              · 나중에 2단계에서, 회원별로 보유 토큰/코인 수량을 연결할 예정입니다.
            </p>
          </div>
        </div>
      </section>

      <!-- 3. 거주 정보 -->
      <section class="panel hidden" id="page-profile">
        <h2>3. 거주 정보 입력</h2>
        <p style="font-size:13px;">
          현재 로그인한 회원의 거주 중인 부동산 정보를 간단히 기록합니다.
          (실습용으로 1건만 저장합니다.)
        </p>
        <div class="grid-2" style="margin-top:8px;">
          <div>
            <div class="field-row">
              <label for="pf-address">주소</label>
              <input type="text" id="pf-address" placeholder="예: 서울시 ○○구 ○○로 101동 1001호" />
            </div>
            <div class="field-row">
              <label for="pf-type">형태</label>
              <input type="text" id="pf-type" placeholder="아파트, 오피스텔, 상가 등" />
            </div>
            <div class="field-row">
              <label for="pf-size">면적/평수</label>
              <input type="text" id="pf-size" placeholder="예: 84㎡, 25평" />
            </div>
            <div class="field-row">
              <label for="pf-note">메모</label>
              <textarea id="pf-note" placeholder="임대 조건, 특징 등을 메모해 보세요."></textarea>
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="btn-save-profile">거주 정보 저장</button>
            </div>
          </div>
          <div>
            <h3>현재 저장된 내용</h3>
            <div class="highlight-box" id="profile-preview">
              아직 저장된 거주 정보가 없습니다.
            </div>
          </div>
        </div>
      </section>

      <!-- 4. 매매·임대 -->
      <section class="panel hidden" id="page-trade">
        <h2>4. 매매·임대 시나리오</h2>
        <p style="font-size:13px;">
          실제 거래를 올리는 것이 아니라, <strong>데이터가 어떻게 토큰으로 변환될지</strong>를 상상하면서
          시나리오를 입력해 보는 곳입니다.
        </p>
        <div class="grid-2" style="margin-top:8px;">
          <div>
            <div class="field-row">
              <label for="tr-address">거래 대상 주소</label>
              <input type="text" id="tr-address" />
            </div>
            <div class="field-row">
              <label for="tr-price">거래 금액(예: 5억 3,000)</label>
              <input type="text" id="tr-price" />
            </div>
            <div class="field-row">
              <label for="tr-type">거래 유형</label>
              <select id="tr-type">
                <option value="sale">매매</option>
                <option value="rent">전세/월세</option>
                <option value="short-rent">단기 임대(일/주 단위)</option>
              </select>
            </div>
            <div class="field-row">
              <label for="tr-note">메모</label>
              <textarea id="tr-note" placeholder="계약 조건, 특약, 수익 배분 아이디어 등을 적어보세요."></textarea>
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="btn-save-trade">거래 시나리오 저장</button>
            </div>
          </div>
          <div>
            <h3>저장된 시나리오</h3>
            <div class="highlight-box" id="trade-preview">
              아직 저장된 거래 시나리오가 없습니다.
            </div>
            <p class="note">
              2단계에서 이 시나리오를 기반으로 <strong>토큰 발행량·참여자 보상</strong> 계산을 붙일 예정입니다.
            </p>
          </div>
        </div>
      </section>

      <!-- 5. 블록체인 개념 -->
      <section class="panel hidden" id="page-concept">
        <h2>5. 블록체인 개념 (요약)</h2>
        <p style="font-size:13px;">
          복잡한 코드를 다 공부하기보다는, <strong>“기록이 어떻게 연결되는지”</strong>를 이해하는 데 초점을 둔 요약 페이지입니다.
        </p>
        <ul style="font-size:13px; padding-left:18px; margin-top:4px;">
          <li><strong>블록(Block)</strong> : 한 덩어리의 기록. (예: 부동산 1호의 거래기록 묶음)</li>
          <li><strong>체인(Chain)</strong> : 블록들이 순서대로 연결된 구조. 앞 블록의 요약(해시)을 다음 블록에 포함.</li>
          <li><strong>해시(Hash)</strong> : 내용을 짧게 요약한 값. 내용이 조금만 달라도 전혀 다른 값이 나옴.</li>
          <li><strong>변조 방지</strong> : 중간 블록을 수정하면 그 뒤 블록들의 해시가 전부 달라져서 쉽게 들킴.</li>
        </ul>
        <p class="note">
          부동산 정보·거래 정보를 토큰/블록으로 바꾸는 실제 코드는  
          <strong>“부동산 자산 디지털화 체험(3단계)”</strong> 메뉴에서 직접 눌러보면서 확인하게 됩니다.
        </p>
      </section>

      <!-- 6. 블록체인 체험(3단계) - 이번 단계에서는 안내만 -->
      <section class="panel hidden" id="page-demo">
        <h2>6. 부동산 자산 디지털화 체험 (3단계)</h2>
        <p style="font-size:13px;">
          이 화면에서는 <strong>3단계</strong>로 나누어, 실제 블록체인과 비슷한 과정을 손으로 눌러보는 연습을 하게 됩니다.
        </p>
        <ol style="font-size:13px; padding-left:18px; margin-top:4px;">
          <li>1단계 : 개념 설명 (이미 위에서 본 내용을 요약)</li>
          <li>2단계 : 부동산·거래·가상 건축 정보 입력</li>
          <li>3단계 : 입력된 정보를 이용해 토큰·해시 값을 만들어 블록체인처럼 연결</li>
        </ol>
        <p class="note">
          지금은 1단계 작업이라 <strong>화면 구조만 준비</strong>해 두었습니다.<br/>
          다음 단계에서, 기존에 갖고 계신 체험 코드(3단계)를 이 페이지 안으로 옮겨서
          해시값·토큰 발행 내역이 실제로 돌아가도록 붙일 예정입니다.
        </p>
      </section>

      <!-- 7. 가상 건축 프로젝트 -->
      <section class="panel hidden" id="page-virtual">
        <h2>7. 가상 건축 프로젝트</h2>
        <p style="font-size:13px;">
          “가상의 건물·리모델링 프로젝트”를 등록해 보고, 나중에 이 프로젝트에도
          토큰을 발행해서 참여자에게 분배하는 구조를 실험하는 공간입니다.
        </p>
        <div class="grid-2" style="margin-top:8px;">
          <div>
            <div class="field-row">
              <label for="vt-title">프로젝트 이름</label>
              <input type="text" id="vt-title" placeholder="예: ○○동 꼬마빌딩 리모델링" />
            </div>
            <div class="field-row">
              <label for="vt-location">위치(가상 또는 실제)</label>
              <input type="text" id="vt-location" />
            </div>
            <div class="field-row">
              <label for="vt-budget">예상 총 사업비</label>
              <input type="text" id="vt-budget" />
            </div>
            <div class="field-row">
              <label for="vt-note">설명</label>
              <textarea id="vt-note" placeholder="층수, 용도, 예상 임대료 등 자유롭게 적어 보세요."></textarea>
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="btn-save-virtual">가상 건축 프로젝트 저장</button>
            </div>
          </div>
          <div>
            <h3>현재 프로젝트 요약</h3>
            <div class="highlight-box" id="virtual-preview">
              아직 등록된 프로젝트가 없습니다.
            </div>
          </div>
        </div>
      </section>

      <!-- 8. 마이페이지 -->
      <section class="panel hidden" id="page-mypage">
        <h2>8. 마이페이지 (요약 보기)</h2>
        <p style="font-size:13px;">
          현재 로그인한 회원의 정보를 한꺼번에 요약해서 보여주는 페이지입니다.
          (거주 정보, 매매/임대 시나리오, 가상 건축 프로젝트 등)
        </p>
        <div class="highlight-box" id="mypage-summary">
          로그인 후 사용해 주세요.
        </div>
      </section>

      <!-- 9. 관리자(설계) -->
      <section class="panel hidden" id="page-admin">
        <h2>9. 관리자(설계용 화면)</h2>
        <p style="font-size:13px;">
          이 화면은 <strong>플랫폼 설계자/관리자</strong>가 토큰 발행 규칙과 보상 구조를 실험해보는 곳입니다.
          (현재는 예시 수치만 보여주고, 2단계에서 실제 조정 기능을 붙일 예정입니다.)
        </p>

        <div class="grid-2" style="margin-top:8px;">
          <div>
            <h3>예시 설정값</h3>
            <div class="field-row">
              <label>부동산 1호 기본 토큰 수</label>
              <input type="number" id="admin-base-token" value="10000" />
            </div>
            <div class="field-row">
              <label>거래 1건당 보너스 토큰</label>
              <input type="number" id="admin-trade-bonus" value="100" />
            </div>
            <div class="field-row">
              <label>광고 1회 노출당 토큰</label>
              <input type="number" id="admin-ad-bonus" value="1" />
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="btn-admin-preview">설정 미리보기</button>
            </div>
            <p class="note">
              지금은 값을 바꾸고 <strong>미리보기</strong>만 할 수 있습니다.<br/>
              다음 단계에서 실제 토큰 계산 로직과 연결하겠습니다.
            </p>
          </div>
          <div>
            <h3>현재 설계 요약</h3>
            <div class="highlight-box" id="admin-preview-box">
              예시 : 부동산 1호당 10,000 토큰 발행, 거래 1건당 100 토큰 보너스, 광고 1회 노출당 1 토큰.
            </div>
          </div>
        </div>
      </section>

    </main>
  </div>

  <script>
    // ========= 공통 유틸 & 상태 =========
    const STORAGE_USERS = "demo-users-v1";
    const STORAGE_SESSION = "demo-current-user-v1";
    const STORAGE_PROFILE = "demo-profile-v1";
    const STORAGE_TRADE = "demo-trade-v1";
    const STORAGE_VIRTUAL = "demo-virtual-v1";

    function loadJSON(key, defaultValue) {
      try {
        const raw = localStorage.getItem(key);
        if (!raw) return defaultValue;
        return JSON.parse(raw);
      } catch (e) {
        console.warn("loadJSON error", key, e);
        return defaultValue;
      }
    }

    function saveJSON(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }

    // 유저 목록 / 세션 불러오기
    function getUsers() {
      const users = loadJSON(STORAGE_USERS, []);
      // 기본 관리자 계정(jung / sam377)이 없다면 추가
      if (!users.find(u => u.id === "jung")) {
        users.push({
          id: "jung",
          pw: "sam377",
          name: "예시 관리자",
          role: "admin"
        });
        saveJSON(STORAGE_USERS, users);
      }
      return users;
    }

    function setUsers(users) {
      saveJSON(STORAGE_USERS, users);
    }

    function getCurrentUser() {
      return loadJSON(STORAGE_SESSION, null);
    }

    function setCurrentUser(user) {
      if (user) {
        saveJSON(STORAGE_SESSION, user);
      } else {
        localStorage.removeItem(STORAGE_SESSION);
      }
      updateLoginUI();
    }

    // ========= 로그인 UI =========
    const sidebarLoginInfo = document.getElementById("sidebar-login-info");
    const loginStatusBox = document.getElementById("login-status-box");
    const loginIdInput = document.getElementById("login-id");
    const loginPwInput = document.getElementById("login-pw");
    const btnLogin = document.getElementById("btn-login");
    const btnLogout = document.getElementById("btn-logout");

    function roleLabel(role) {
      switch (role) {
        case "resident": return "거주자";
        case "owner": return "매매/임대 운영자";
        case "advertiser": return "광고주";
        case "architect": return "가상 건축 설계자";
        case "admin": return "관리자";
        default: return "일반 회원";
      }
    }

    function updateLoginUI() {
      const user = getCurrentUser();
      if (!user) {
        sidebarLoginInfo.innerHTML = `
          <span>현재 로그인: <strong>없음</strong></span>
          <span style="margin-top:4px;">예시 계정 jung / sam377 또는 회원가입 후 로그인해 보세요.</span>
          <button id="btn-sidebar-focus-login">로그인 칸으로 이동</button>
        `;
        loginStatusBox.textContent = "아직 로그인하지 않았습니다.";
      } else {
        sidebarLoginInfo.innerHTML = `
          <span><strong>${user.name || user.id}</strong> 님</span>
          <span>역할: ${roleLabel(user.role)} <span class="badge-role">${user.role}</span></span>
          <button id="btn-sidebar-logout">로그아웃</button>
        `;
        loginStatusBox.innerHTML = `
          <strong>${user.name || user.id}</strong> 님이 로그인 중입니다.<br/>
          역할: ${roleLabel(user.role)} (${user.role})
        `;
      }

      const focusBtn = document.getElementById("btn-sidebar-focus-login");
      if (focusBtn) {
        focusBtn.onclick = () => {
          loginIdInput.focus();
          window.scrollTo({ top: 0, behavior: "smooth" });
        };
      }
      const sidebarLogout = document.getElementById("btn-sidebar-logout");
      if (sidebarLogout) {
        sidebarLogout.onclick = () => {
          setCurrentUser(null);
          alert("로그아웃되었습니다.");
        };
      }

      updateMypageSummary();
      updateProfilePreview();
      updateTradePreview();
      updateVirtualPreview();
    }

    btnLogin.addEventListener("click", () => {
      const id = loginIdInput.value.trim();
      const pw = loginPwInput.value.trim();
      if (!id || !pw) {
        alert("아이디와 비밀번호를 입력해 주세요.");
        return;
      }
      const users = getUsers();
      const user = users.find(u => u.id === id && u.pw === pw);
      if (!user) {
        alert("일치하는 계정을 찾을 수 없습니다. (예시: jung / sam377)");
        return;
      }
      setCurrentUser(user);
      alert("로그인되었습니다.");
    });

    btnLogout.addEventListener("click", () => {
      setCurrentUser(null);
      alert("로그아웃되었습니다.");
    });

    // ========= 메뉴 전환 =========
    const menuButtons = document.querySelectorAll(".menu-btn");
    const pages = {
      home: document.getElementById("page-home"),
      signup: document.getElementById("page-signup"),
      profile: document.getElementById("page-profile"),
      trade: document.getElementById("page-trade"),
      concept: document.getElementById("page-concept"),
      demo: document.getElementById("page-demo"),
      virtual: document.getElementById("page-virtual"),
      mypage: document.getElementById("page-mypage"),
      admin: document.getElementById("page-admin")
    };

    function showPage(key) {
      Object.keys(pages).forEach(k => {
        if (pages[k]) {
          pages[k].classList.toggle("hidden", k !== key);
        }
      });
      menuButtons.forEach(btn => {
        btn.classList.toggle("active", btn.dataset.page === key);
      });
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    menuButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const key = btn.dataset.page;
        showPage(key);
      });
    });

    // ========= 회원가입 =========
    const suId = document.getElementById("su-id");
    const suPw = document.getElementById("su-pw");
    const suName = document.getElementById("su-name");
    const suRole = document.getElementById("su-role");
    const btnSignup = document.getElementById("btn-signup");

    btnSignup.addEventListener("click", () => {
      const id = suId.value.trim();
      const pw = suPw.value.trim();
      const name = suName.value.trim();
      const role = suRole.value;

      if (!id || !pw) {
        alert("아이디와 비밀번호를 입력해 주세요.");
        return;
      }

      const users = getUsers();
      if (users.find(u => u.id === id)) {
        alert("이미 존재하는 아이디입니다.");
        return;
      }

      users.push({ id, pw, name, role });
      setUsers(users);
      alert("회원가입이 완료되었습니다. 이제 로그인해 보세요.");
      suId.value = "";
      suPw.value = "";
      suName.value = "";
      suRole.value = "resident";
    });

    // ========= 거주 정보 저장 =========
    const pfAddress = document.getElementById("pf-address");
    const pfType = document.getElementById("pf-type");
    const pfSize = document.getElementById("pf-size");
    const pfNote = document.getElementById("pf-note");
    const btnSaveProfile = document.getElementById("btn-save-profile");
    const profilePreview = document.getElementById("profile-preview");

    function updateProfilePreview() {
      const user = getCurrentUser();
      if (!user) {
        profilePreview.textContent = "로그인 후 사용해 주세요.";
        return;
      }
      const all = loadJSON(STORAGE_PROFILE, {});
      const data = all[user.id];
      if (!data) {
        profilePreview.textContent = "아직 저장된 거주 정보가 없습니다.";
        return;
      }
      profilePreview.innerHTML = `
        <strong>${user.name || user.id}</strong> 님의 거주 정보<br/>
        주소: ${data.address || "-"}<br/>
        형태: ${data.type || "-"}, 면적: ${data.size || "-"}<br/>
        메모: ${data.note || "-"}
      `;
    }

    btnSaveProfile.addEventListener("click", () => {
      const user = getCurrentUser();
      if (!user) {
        alert("먼저 로그인해 주세요.");
        return;
      }
      const all = loadJSON(STORAGE_PROFILE, {});
      all[user.id] = {
        address: pfAddress.value.trim(),
        type: pfType.value.trim(),
        size: pfSize.value.trim(),
        note: pfNote.value.trim()
      };
      saveJSON(STORAGE_PROFILE, all);
      alert("거주 정보를 저장했습니다.");
      updateProfilePreview();
    });

    // ========= 매매/임대 시나리오 =========
    const trAddress = document.getElementById("tr-address");
    const trPrice = document.getElementById("tr-price");
    const trType = document.getElementById("tr-type");
    const trNote = document.getElementById("tr-note");
    const btnSaveTrade = document.getElementById("btn-save-trade");
    const tradePreview = document.getElementById("trade-preview");

    function updateTradePreview() {
      const user = getCurrentUser();
      if (!user) {
        tradePreview.textContent = "로그인 후 사용해 주세요.";
        return;
      }
      const all = loadJSON(STORAGE_TRADE, {});
      const data = all[user.id];
      if (!data) {
        tradePreview.textContent = "아직 저장된 거래 시나리오가 없습니다.";
        return;
      }
      tradePreview.innerHTML = `
        <strong>${user.name || user.id}</strong> 님의 거래 시나리오<br/>
        주소: ${data.address || "-"}<br/>
        유형: ${roleLabelTrade(data.type)} / 금액: ${data.price || "-"}<br/>
        메모: ${data.note || "-"}
      `;
    }

    function roleLabelTrade(t) {
      switch (t) {
        case "sale": return "매매";
        case "rent": return "전세/월세";
        case "short-rent": return "단기 임대";
        default: return t;
      }
    }

    btnSaveTrade.addEventListener("click", () => {
      const user = getCurrentUser();
      if (!user) {
        alert("먼저 로그인해 주세요.");
        return;
      }
      const all = loadJSON(STORAGE_TRADE, {});
      // 같은 회원은 하나의 시나리오만 (중복 누적 방지)
      all[user.id] = {
        address: trAddress.value.trim(),
        price: trPrice.value.trim(),
        type: trType.value,
        note: trNote.value.trim()
      };
      saveJSON(STORAGE_TRADE, all);
      alert("거래 시나리오를 저장했습니다. (동일 회원은 덮어쓰기 됩니다)");
      updateTradePreview();
    });

    // ========= 가상 건축 =========
    const vtTitle = document.getElementById("vt-title");
    const vtLocation = document.getElementById("vt-location");
    const vtBudget = document.getElementById("vt-budget");
    const vtNote = document.getElementById("vt-note");
    const btnSaveVirtual = document.getElementById("btn-save-virtual");
    const virtualPreview = document.getElementById("virtual-preview");

    function updateVirtualPreview() {
      const user = getCurrentUser();
      if (!user) {
        virtualPreview.textContent = "로그인 후 사용해 주세요.";
        return;
      }
      const all = loadJSON(STORAGE_VIRTUAL, {});
      const data = all[user.id];
      if (!data) {
        virtualPreview.textContent = "아직 등록된 프로젝트가 없습니다.";
        return;
      }
      virtualPreview.innerHTML = `
        <strong>${user.name || user.id}</strong> 님의 가상 건축 프로젝트<br/>
        이름: ${data.title || "-"}<br/>
        위치: ${data.location || "-"}<br/>
        예산: ${data.budget || "-"}<br/>
        설명: ${data.note || "-"}
      `;
    }

    btnSaveVirtual.addEventListener("click", () => {
      const user = getCurrentUser();
      if (!user) {
        alert("먼저 로그인해 주세요.");
        return;
      }
      const all = loadJSON(STORAGE_VIRTUAL, {});
      all[user.id] = {
        title: vtTitle.value.trim(),
        location: vtLocation.value.trim(),
        budget: vtBudget.value.trim(),
        note: vtNote.value.trim()
      };
      saveJSON(STORAGE_VIRTUAL, all);
      alert("가상 건축 프로젝트를 저장했습니다. (동일 회원은 덮어쓰기 됩니다)");
      updateVirtualPreview();
    });

    // ========= 마이페이지 요약 =========
    const mypageSummary = document.getElementById("mypage-summary");

    function updateMypageSummary() {
      const user = getCurrentUser();
      if (!user) {
        mypageSummary.textContent = "로그인 후 사용해 주세요.";
        return;
      }
      const profiles = loadJSON(STORAGE_PROFILE, {});
      const trades = loadJSON(STORAGE_TRADE, {});
      const virtuals = loadJSON(STORAGE_VIRTUAL, {});
      const p = profiles[user.id];
      const t = trades[user.id];
      const v = virtuals[user.id];

      mypageSummary.innerHTML = `
        <strong>${user.name || user.id}</strong> 님 (역할: ${roleLabel(user.role)}) 요약<br/><br/>
        ▸ 거주 정보: ${p ? (p.address || "-") : "등록 안 됨"}<br/>
        ▸ 거래 시나리오: ${t ? (t.address || "-") : "등록 안 됨"}<br/>
        ▸ 가상 건축: ${v ? (v.title || "-") : "등록 안 됨"}<br/>
        <br/>
        상세 내용은 각 메뉴에서 수정하실 수 있습니다.
      `;
    }

    // ========= 관리자 미리보기 =========
    const adminBaseToken = document.getElementById("admin-base-token");
    const adminTradeBonus = document.getElementById("admin-trade-bonus");
    const adminAdBonus = document.getElementById("admin-ad-bonus");
    const adminPreviewBox = document.getElementById("admin-preview-box");
    const btnAdminPreview = document.getElementById("btn-admin-preview");

    btnAdminPreview.addEventListener("click", () => {
      const base = Number(adminBaseToken.value || "0");
      const trade = Number(adminTradeBonus.value || "0");
      const ad = Number(adminAdBonus.value || "0");
      adminPreviewBox.innerHTML = `
        부동산 1호당 <strong>${base.toLocaleString()}</strong> 토큰 발행,<br/>
        거래 1건당 <strong>${trade.toLocaleString()}</strong> 토큰 보너스,<br/>
        광고 1회 노출당 <strong>${ad.toLocaleString()}</strong> 토큰 지급<br/>
        이 구조를 기준으로 2단계에서 실제 보상 계산을 연결할 예정입니다.
      `;
    });

    // ========= 초기화 =========
    updateLoginUI();
    showPage("home");
  </script>
</body>
</html>
